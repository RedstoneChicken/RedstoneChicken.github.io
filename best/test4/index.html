<body>
<p>
Number of downloads: <?php echo(filesize($LocationOfCountFile)) ?>
</p>
</body>
<?php
/*
   Download Logger and Counter
   Version 1.0
   November 11, 2019
   Will Bontrager Software LLC
   https://www.willmaster.com/
*/

/* *** Customizations *** */
// 3 places to customize:

// Place 1:
// The URL of the downloadable file.
$URLofDownloadableFile = "/downloads/thedoc.zip";

// Place 2:
// Optionally, the location of the download log CSV file. Otherwise, leave blank.
$LocationOfLogFile = "/downloads/log/log.csv";

// Place 3:
// Optionally, the location of the download count file. Otherwise, leave blank.
$LocationOfCountFile = "/downloads/log/count.txt";

/* *** End of Customizations *** */

if( (!empty($LocationOfCountFile)) and strlen($LocationOfCountFile)>2 )
{
   if( strpos($LocationOfCountFile,'/')===0 ) { $LocationOfCountFile = "{$_SERVER['DOCUMENT_ROOT']}$LocationOfCountFile"; }
   file_put_contents($LocationOfCountFile,'x',FILE_APPEND);
}
if( (!empty($LocationOfLogFile)) and strlen($LocationOfLogFile)>2 )
{

   if( strpos($LocationOfLogFile,'/')===0 ) { $LocationOfLogFile = "{$_SERVER['DOCUMENT_ROOT']}$LocationOfLogFile"; }
   $LogCell = array();
   $LogCell[] = date('r');
   $LogCell[] = $_SERVER['REMOTE_ADDR'];
   $LogCell[] = str_replace('"','""',$URLofDownloadableFile);
   $LogCell[] = str_replace('"','""',$_SERVER['HTTP_USER_AGENT']);
   file_put_contents($LocationOfLogFile,'"'.implode('","',$LogCell)."\"\n",FILE_APPEND);
   $filehandle = fopen($LocationOfLogFile,'a');
}
?>
<meta http-equiv="refresh" content="0; url=<?php echo($URLofDownloadableFile) ?>">